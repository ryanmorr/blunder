/*! @ryanmorr/blunder v0.1.1 | https://github.com/ryanmorr/blunder */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).blunder={})}(this,(function(e){"use strict";const t=window.document,n=t.documentElement,r=window.navigator,o=window.screen,i=window.performance;const c="<unknown>",a=/^\s*at\s(?:(.*?)(?=(?:\s\())\s)?\(?(?:((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/|[a-z]:\\|\\\\).*?))(?::(\d+))?(?::(\d+))?\)?\s*$/i,s=/^\s*(.*?)?(?:^|@)(?:((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle))(?::(\d+))?(?::(\d+))?\s*$/i;function u(e){return void 0===e?e=function(e){const t=new Error;return Error.captureStackTrace&&Error.captureStackTrace(t,e),t.stack}(u):e instanceof Error&&(e=e.stack),function(e){return e.split("\n").reduce(((e,t)=>{let n=t.match(a)||t.match(s);if(n){const[,t,r,o,i]=n;e.push({functionName:t||c,fileName:r,lineNumber:o?+o:null,columnNumber:i?+i:null})}return e}),[])}(e)}class d extends Error{constructor(e,c={}){super(e),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:this.constructor.name,writable:!0}),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),"string"!=typeof this.stack&&Object.defineProperty(this,"stack",{configurable:!0,enumerable:!1,value:new Error(e).stack,writable:!0}),this.detail=c,this.meta=function(){const e={datetime:(new Date).toString(),timestamp:Date.now(),userAgent:r.userAgent,url:t.location.href,referrer:t.referrer,cookie:r.cookieEnabled?t.cookie:"<disabled>",language:r.language||r.userLanguage,readyState:t.readyState,viewportWidth:window.innerWidth,viewportHeight:window.innerHeight};return o&&o.orientation&&o.orientation.type?e.orientation=o.orientation.type:e.orientation=n.clientWidth>n.clientHeight?"landscape":"portrait",r.connection&&r.connection.effectiveType&&(e.connection=r.connection.effectiveType),i&&i.memory&&(e.memory=Math.round(i.memory.usedJSHeapSize/1048576),e.memoryPercent=Math.round(i.memory.usedJSHeapSize/i.memory.jsHeapSizeLimit*100)),e}()}get stacktrace(){return this._stacktrace||(this._stacktrace=u(this.stack)),this._stacktrace}toJSON(){return{name:this.name,message:this.message,stack:this.stack,meta:this.meta,stacktrace:this.stacktrace,detail:Object.keys(this.detail).reduce(((e,t)=>{let n=this.detail[t];const r={}.toString.call(n).slice(8,-1);return"Date"!==r&&"Function"!==r||(n=n.toString()),e[t]=n,e}),{})}}static from(e,t){const n=this;if(e instanceof n)return t&&(e.detail=Object.assign(e.detail,t)),e;if(e instanceof Error){const r=new n(e.message,t);return r.stack=e.stack,r.source=e,r}return new n(e,t)}}const l=[],m=new WeakSet;function f(e,t){const n=d.from(e,t);return m.has(n)||(m.add(n),l.slice().forEach((e=>e(n)))),n}let h=!1,p=!1,w=!1;function k(e){e.preventDefault(),f(d.from(e.error))}function b(e){e.preventDefault(),f(d.from(e.reason,{promise:e.promise}))}function g(e){e.preventDefault(),f(d.from(e.reason,{promise:e.promise}))}function y(){h&&(h=!1,window.removeEventListener("error",k)),p&&(p=!1,window.removeEventListener("unhandledrejection",b)),w&&(w=!1,window.removeEventListener("rejectionhandled",g))}e.Exception=d,e.attempt=function(e,t){const n=new Promise(((n,r)=>{try{n(e())}catch(e){r(d.from(e,t))}}));return n.catch(f),n},e.dispatch=f,e.monitor=function({error:e=!0,unhandledrejection:t=!0,rejectionhandled:n=!0}={}){return h||p||w||(e&&(h=!0,window.addEventListener("error",k,!0)),t&&(p=!0,window.addEventListener("unhandledrejection",b)),n&&(w=!0,window.addEventListener("rejectionhandled",g))),y},e.report=function(e,t){return new Promise(((n,r)=>{const o=e=>r(d.from(e));fetch(e,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).catch(o).then((e=>e.ok?e.json():Promise.reject(d.from(e.statusText)))).then(n).catch(o)}))},e.stacktrace=u,e.subscribe=function(e){return l.push(e),()=>{const t=l.indexOf(e);-1!==t&&l.splice(t,1)}}}));
