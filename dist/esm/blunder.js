/*! @ryanmorr/blunder v1.0.0 | https://github.com/ryanmorr/blunder */
function e(n,t=new WeakSet){if(null==n)return n;if(t.has(n))return"[Circular]";const r=function(e){return{}.toString.call(e).slice(8,-1)}(n);return"String"===r||"Number"===r||"Boolean"===r||"Date"===r?n:"Function"===r?`[Function: ${n.name||"anonymous"}]`:"Array"===r?function(n,t){t.add(n);const r=n.map((n=>e(n,t)));return t.delete(n),r}(n,t):"Object"===r?function(n,t){t.add(n);const r={};for(const[s,a]of Object.entries(n))r[s]=e(a,t);return t.delete(n),r}(n,t):n instanceof Error?"function"==typeof n.serializable?function(n,t){t.add(n);const r=e(n.serializable(),t);return t.delete(n),r}(n,t):function(n,t){t.add(n);const r={name:n.name,message:n.message,stack:n.stack};return"cause"in n&&(r.cause=e(n.cause,t)),t.delete(n),r}(n,t):void 0}function n(e,n,t){Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value:t,writable:!0})}class t extends Error{constructor(e,t={}){const{cause:r=null,...s}=t;super(e,{cause:r}),n(this,"name",this.constructor.name),"cause"in this||n(this,"cause",r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),"string"!=typeof this.stack&&n(this,"stack",new Error(e).stack),n(this,"data",s)}serializable(){return{name:this.name,message:this.message,stack:this.stack,cause:this.cause,data:this.data}}toJSON(){return e(this)}toString(){return`${this.name}: ${this.message}`}static from(e,n){const t=this;if(e instanceof t){if(n){const{cause:t=null,...r}=n;Object.assign(e.data,r),t&&(e.cause=t)}return e}if(e instanceof Error){const{message:r,stack:s,cause:a,errors:o}=e,c=new t(r,n);return c.stack=s,a?c.cause=a:o&&(c.cause=o.slice()),c.source=e,c}return new t(String(e),n)}}const r=[],s=new WeakSet;function a(e){return r.push(e),()=>{const n=r.indexOf(e);-1!==n&&r.splice(n,1)}}function o(e,n){const a=t.from(e,n);return s.has(a)||(s.add(a),r.slice().forEach((e=>e(a)))),a}let c=!1,i=!1,u=!1;function d(e){e.preventDefault(),o(t.from(e.error,{event:e}))}function f(e){e.preventDefault(),o(t.from(e.reason,{event:e}))}function l(e){e.preventDefault(),o(t.from(e.reason,{event:e}))}function h(){c&&(c=!1,window.removeEventListener("error",d)),i&&(i=!1,window.removeEventListener("unhandledrejection",f)),u&&(u=!1,window.removeEventListener("rejectionhandled",l))}function m({error:e=!0,unhandledrejection:n=!0,rejectionhandled:t=!0}={}){return c||i||u||(e&&(c=!0,window.addEventListener("error",d,!0)),n&&(i=!0,window.addEventListener("unhandledrejection",f)),t&&(u=!0,window.addEventListener("rejectionhandled",l))),h}function v(e){return[void 0,e]}function w(e){return[e,void 0]}function g(e,n){return e.then((e=>w(e)),(e=>v(o(e,n))))}function k(e,n){if(e instanceof Promise)return g(e,n);try{const t=e();return t instanceof Promise?g(t,n):w(t)}catch(e){return v(o(e,n))}}export{t as Exception,k as attempt,o as dispatch,m as monitor,a as subscribe};
